{% extends 'base.html.twig' %}

{% block title %}Pharmacie de garde
{% endblock %}

{% block stylesheets %}
	<link rel="stylesheet" href="{{ asset('assets/css/styles.css') }}">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-xxx" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
	<link rel="preload" href="path/to/resource" as="style">

{% endblock %}

{% block body %}
	<div class="container">

		<header class="row align-items-center">

			<style>


				body {
					min-height: 100vh;
					display: flex;
					flex-direction: column;
				}

				main {
					flex: 1;
				}

				header {
					display: flex;
					justify-content: space-between;
					align-items: center;
					padding: 10px 0;
				}

				h1 {
					color: #0056b3;
					font-size: 30px;
				}

				.notifications img {
					width: 24px;
					height: 24px;

				}


				.pharmacy-list {
					list-style-type: none;
					padding: 0;
					margin: 20px 0;
				}

				.pharmacy-item {
					display: flex;
					justify-content: space-between;
					align-items: center;
					background-color: #fff;
					padding: 10px 20px;
					border-radius: 25px;
					margin-bottom: 10px;
					box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
					position: relative;
				}

				.pharmacy-item img {
					width: 70px;
					height: 70px;
				}

				.btn-disponible {
					background-color: #28a745;
					color: white;
					border: none;
					padding: 8px 20px;
					border-radius: 25px;
					cursor: pointer;
				}

				.btn-disponible:hover {
					background-color: #218838;
				}

				.nmPh {
					font-weight: 900;
					font-size: 23px;
					flex-grow: 1;
					top: 18px;
					font-family: "Blippo", fantasy;
					color: #0056b3;
				}

				.nmMdc {
					display: block;

					margin-top: 10%;
					font-size: 17px;
					color: black;
					font-family: "Comic Sans MS", cursive, sans-serif;

					padding: 2%;
					border-radius: 30px;
				}

				.bottom-nav {
					display: flex;
					justify-content: space-around;
					align-items: center;
					padding: 10px 0;
					background-color: #fff;
					border-top: 1px solid #ddd;
					position: fixed;
					bottom: 0;
					width: 100%;
					height: 75px;
					box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
				}

				.bottom-nav a {
					color: #0056b3;
					text-decoration: none;
					font-size: 14px;
					text-align: center;
				}

				.nav-item {
					text-align: center;
					flex: 1;
				}

				.nav-item svg {
					display: block;
					margin: 0 auto 5px;
					text-align: center;
				}

				.nav-item span {
					display: block;
					font-size: 20px;
					color: #333;
				}
				.strong {
					font-size: 20px;
					color: rgb(42, 63, 251);
				}
				.card-title {
					font-family: "Brush Script MT", cursive;
					text-align: center;
					font-weight: bolder;
					font-size: 48px;
					color: #0839CF;


				}
				#btn-insponible {
					background: red;
					font-size: 14px;
				}

				main {
					margin-top: 5%;
				}

				.search-bar {
					display: flex;
					align-items: center;
					justify-content: center;
				}

				.search-bar input {
					padding: 10px;
					border-radius: 25px;
					border: 1px solid #0839CF;
					width: 100%;
					box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
				}

				.search-btn {
					background-color: transparent;
					border: none;
					margin-left: -35px;
				}
				@media(max-width: 992px) {
					header {
						flex-direction: column;
					}

					.search-bar input {
						width: 100%;
					}

					#locfr {
						margin-left: -100%;
					}

					.notifications {

						margin-top: -31%;
						position: absolute;
						margin-right: -99%;


					}
				}

				@media(max-width: 768px) {
					.pharmacy-item {
						flex-direction: column;
						align-items: flex-start;
					}

					.nmPh,
					.nmMdc {
						font-size: 16px;
					}

					.btn-disponible {
						width: 100%;
						text-align: center;
						margin-top: 10px;
					}
				}

				@media(max-width: 576px) {
					.search-bar input {
						width: 100%;
					}

					.bottom-nav {
						flex-direction: column;
						height: auto;
					}

					.nav-item {
						margin-bottom: 10px;
					}

					.nav-item span {
						font-size: 10px;
					}

					.notifications {
						margin-top: 10px;
					}
				}
				@media(max-width:1492px) {
					footer {
						margin-left: -13%;
						position: relative;

					}
				}
				@media(max-width:1448px) {
					footer {
						margin-left: -13%;
						position: relative;

					}
				}

				footer {
					position: relative; /* ou fixed si vous voulez qu'il reste en bas */
					width: 100%;
					margin: 0; /* Supprimez les marges négatives */
					padding: 10px 0;
					background-color: #fff;
					text-align: center;
					box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
					bottom: 0; /* Garder le footer en bas */
				}

				@media(max-width: 992px) {
					footer {
						margin-left: 0;
						padding: 10px;
						text-align: center;
						font-size: xx-large;
					}
					.notifications {
						margin-left: 150px;
						position: absolute;

					}
					.card-text {
						font-size: 40px;
					}
					.nmp {
						font-size: 40px;
					}
					.strong {
						font-size: 40px;
						color: rgb(42, 63, 251);
						.card-title {
							font-family: "Brush Script MT", cursive;
							text-align: center;
							font-weight: bolder;
							font-size: 40px;
							color: #0839CF;


						}
					}

				}


				.description {
					margin-left: 11%; /* Ajuste la valeur selon la quantité de décalage que tu souhaites */
					color: #6c757d; /* Conserve la couleur du texte comme texte-muted */
					font-size: 14px; /* Ajuste la taille de la police si nécessaire */
					line-height: 1.5; /* Ajuste l'espacement entre les lignes pour une meilleure lisibilité */
					margin-top: -4%;

				}
				.btn-primary {
					border-radius: 35%;
					transition: 2s;
				}


				.notification-badge {
					position: absolute;
					top: -10px;
					right: -10px;
					background-color: red;
					color: white;
					border-radius: 50%;
					width: 20px;
					height: 20px;
					display: flex;
					align-items: center;
					justify-content: center;
					font-size: 12px;
					font-weight: bold;
				}
				.modal-content {
					border-radius: 20px;
					padding: 30px;
					box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
				}

				.modal-title {
					font-family: "Luminari", "Comic Sans MS", cursive, sans-serif;
					font-size: 1.3rem;
					color: #0839CF;
				}

				.modal-body .notification-date {
					font-family: 'Arial', sans-serif;
					font-size: 1rem;
					color: #666666;
				}

				.modal-body .notification-body {
					font-family: 'Arial', sans-serif;
					font-size: 1rem;
					margin-top: 10px;
					color: #333333;
				}

				.btn-primary {
					border-radius: 20px;
					background-color: #0839CF;
					color: #ffffff;
				}

				.btn-primary:hover {
					background-color: #052a94;
				}
				@media(max-width: 992px) {
					footer {

						margin-left: 0;
						padding: 10px;
						text-align: center;

					}

					.bottom-nav svg {
						height: 40px;
						width: 40px;
						margin-left: -2%;
					}
					.bottom-nav {
						height: 100px;

					}
					span {
						margin-left: -82%;
					}
					.imgs {
						height: 130px;
						width: 130px;
					}
					.conta {
						text-align: center;
						margin-left: 45%;

					}
					.ccc {
						display: none;
					}
					.modal-content {

						font-size: 30px;
					}

					.modal-title {
						font-size: 30px;
					}

					.modal-body .notification-date {
						font-family: 'Arial', sans-serif;
						font-size: 2rem;
						color: #666666;

					}

					.modal-body .notification-body {
						font-size: 30px;
					}
					.notificone {
						height: 60px;
						width: 60px;

					}
					.notification-badge {
						font-size: 20px;
						width: 28px;
						height: 28px;
						top: -10px;
						right: 40.1px;
					}
					.imgl {
						height: 120px;
						width: 210px;
						display: block;
						position: relative;
					}

				}
				@keyframes strongShake {
					0% {
						transform: rotate(0deg);
					}
					10% {
						transform: rotate(10deg);
					}
					20% {
						transform: rotate(-10deg);
					}
					30% {
						transform: rotate(10deg);
					}
					40% {
						transform: rotate(-10deg);
					}
					50% {
						transform: rotate(8deg);
					}
					60% {
						transform: rotate(-8deg);
					}
					70% {
						transform: rotate(5deg);
					}
					80% {
						transform: rotate(-5deg);
					}
					90% {
						transform: rotate(2deg);
					}
					100% {
						transform: rotate(0deg);
					}
				}

				.vibrate-strong {
					animation: strongShake 0.7s;
					animation-iteration-count: 1;
					transform-origin: top center; /* Fixer le sommet */
				}
			</style>
			<nav style="margin-top: -12%;">
				<div class="container">
					<header class="row align-items-center" style="margin-top: 10%;">
						<div class="col-md-4 text-center text-md-start">
							<a href="{{ path('app_index') }}">
								<img class="imgl" src="{{ asset('images/iconelocapharna.png') }}" id="locfr" width="206" height="100" alt="Pharmacy Icon">
							</a>
						</div>
						<div class="col-md-4 text-center text-md-end">
							<a href="" data-bs-toggle="modal" data-bs-target="#notificationModal">
								<div class="notifications position-relative">
									<i class="bi bi-bell"></i>
									<svg class="notificone" style="color: #0839CF;" xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-bell-fill" viewbox="0 0 16 16">
										<path d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2m.995-14.901a1 1 0 1 0-1.99 0A5 5 0 0 0 3 6c0 1.098-.5 6-2 7h14c-1.5-1-2-5.902-2-7 0-2.42-1.72-4.44-4.005-4.901"/>
									</svg>

									{% if notification_count > 0 %}
										<span class="notification-badge">{{ notification_count }}</span>
									{% endif %}
								</div>
							</a>
						</div>

						<div class="modal fade" id="notificationModal" tabindex="-1" aria-labelledby="notificationModalLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="notificationModalLabel" style="font-size: 15px;">Tous les notification</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									{% for notification in notifications %}
										<div class="modal-body">
											<p class="modal-title ">{{ notification.title }}</p>
											<p class="notification-body">{{ notification.body }}</p>
											<p class="notification-date" style="float:right;margin-top:25px;">Publié le
												{{ notification.createdAt|date('d M Y') }}</p>
										</div>
										<hr>
									{% else %}
										<p>Aucune notification disponible.</p>
									{% endfor %}
									<div class="modal-footer">
										<button type="button" class="btn btn-primary" data-bs-dismiss="modal">Quitter</button>
									</div>
								</div>
							</div>
						</div>
					</header>

					<main class="container mt-5" style="margin-top: 5%; border-radius: 5%; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);">
						<div class="card mb-3" style="margin-top: 5%; border-radius: 5%; border: none;">
							<img src="{{ asset('images/grdph.jpeg') }}" alt="Medicament Icon" style=" border-radius: 5%; filter: blur(4px); opacity: 0.5;  height: 300px;">
							<div class="card-body" style="margin-top: -5%; border-radius: 5%; padding: 7%;">
								<center><img src="{{ asset('images/pharmacy-icon.jpg') }}" alt="Medicament Icon" style="   height: 180px;"></center>
								<p class="card-title" style="">Pharmacie de Garde</p>
								{% if message %}
									<b>
										<p class="card-text" style="text-align: center; font-size:25px; color:red;">
											{{message}}
										</p>
									</b>

								</div>

							</div>

						{% else %}
							<p class="card-text" style="text-align: center; ">La pharmacie de garde cette semaine est
								<strong class="strong" style="f">{{ pharmacie.nomPharma }}</strong>. 
																																					    Située en plein cœur de la ville, 
																																					    cette pharmacie est ouverte pour répondre à vos besoins urgents en médicaments et en soins. 
																																					    Elle sera à votre service du
								<strong class="strong">{{ planning.dateDebut ? planning.dateDebut|date('H:i') : 'Non spécifié' }}
									à
									{{ planning.dateFin ? planning.dateFin|date('H:i') : 'Non spécifié' }}</strong>, assurant une disponibilité continue pour vous 
																																					    et vos proches.

							</p>
							<p class="card-text" style="text-align: center;  margin-top: 5%; ">
								En cas de besoin, vous pouvez facilement contacter la pharmacie de garde avec
																																	  le numéro de téléphone ci-dessous.
								<strong class="strong">{{ pharmacie.nomPharma }}</strong>
								se tient prête à vous assister avec professionnalisme et attention.
							</p>

						</div>

					</div>
					<div class="conta" style="text-align: center;">
						<a href="#" style="text-decoration:none">
							<svg class="ccc" xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-telephone-fill" viewbox="0 0 16 16">
								<path fill-rule="evenodd" d="M1.885.511a1.745 1.745 0 0 1 2.61.163L6.29 2.98c.329.423.445.974.315 1.494l-.547 2.19a.68.68 0 0 0 .178.643l2.457 2.457a.68.68 0 0 0 .644.178l2.189-.547a1.75 1.75 0 0 1 1.494.315l2.306 1.794c.829.645.905 1.87.163 2.611l-1.034 1.034c-.74.74-1.846 1.065-2.877.702a18.6 18.6 0 0 1-7.01-4.42 18.6 18.6 0 0 1-4.42-7.009c-.362-1.03-.037-2.137.703-2.877z"/>
							</svg><br>
							<span class="strong">Contactez la Pharmacie :
								{{ pharmacie.tel }}
							</span>
						</div>
					{% endif %}
					<main></div>
				</div>
				<!-- Bouton de contact -->
			</main>
		</div>
		<footer>
			<nav class="bottom-nav">
				<a href="{{ path('app_index') }}" class="imgs" style="margin-left: 10%;">
					<img src="{{ asset('images/logoloca-removebg-preview.png') }}" id="locfr" width="115" height="115" alt="Pharmacy Icon">
				</a>
				<a href="{{ path('app_index') }}" class="nav-item">
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-house-fill" viewbox="0 0 16 16">
						<path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L8 2.207l6.646 6.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293z"/>
						<path d="m8 3.293 6 6V13.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5V9.293z"/>
					</svg>
					<span>Accueil</span>
				</a> 
				<a href="{{ path('pharmacie_proche') }}" class="nav-item">
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-geo-alt-fill" viewbox="0 0 16 16">
						<path fill-rule="evenodd" d="M12 6a4 4 0 1 0-8 0 4 4 0 0 0 8 0ZM8 0a6 6 0 0 0-6 6c0 1.7.924 3.68 2.287 5.329.678.843 1.454 1.593 2.155 2.146.354.28.688.528.958.711.134.091.252.165.345.217l.066.036.017.01h.002l.001.001s0-.001.4.202a.25.25 0 0 0 .234 0s.4-.202.4-.202l.002-.001h.001l.017-.01.066-.036c.093-.052.211-.126.345-.217.27-.183.604-.43.958-.711.701-.553 1.477-1.303 2.155-2.146C13.076 9.68 14 7.7 14 6a6 6 0 0 0-6-6Z"/>
					</svg>
					<span>Pharmacie proche</span>
				</a>
				<a href="{{ path('pharmacie_garde') }}" class="nav-item">
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" ç fill="currentColor" class="bi bi-clock-fill" viewbox="0 0 16 16">
						<path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0ZM7.5 3.5a.5.5 0 0 0-1 0V8a.5.5 0 0 0 .276.447l3.5 1.75a.5.5 0 0 0 .448-.894L7.5 7.742V3.5Z"/>
					</svg>
					<span>Pharmacie de garde</span>
				</a>
				<a href="{{ path('recherche_medicament') }}" class="nav-item">
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-search" viewbox="0 0 16 16">
						<path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001a1.007 1.007 0 0 0-.116.125l-2.45 2.45a1 1 0 0 0 1.415 1.415l2.45-2.45a1.007 1.007 0 0 0 .125-.116v-.001a6.5 6.5 0 0 0 1.398-1.397zm-6.321-5.027a5.5 5.5 0 1 1 7.778 7.778 5.5 5.5 0 0 1-7.778-7.778z"/>
					</svg>
					<span>Médicaments</span>
				</a>

			</nav>
		</footer>
		<script>
			document.addEventListener('DOMContentLoaded', function () {
const pharmacyModal = document.getElementById('pharmacyModal');

pharmacyModal.addEventListener('hidden.bs.modal', function () { // Supprimer manuellement les éléments de l'overlay
const backdrop = document.querySelector('.modal-backdrop');
if (backdrop) {
backdrop.remove();
}
document.body.classList.remove('modal-open'); // Supprimer la classe qui empêche le défilement
document.body.style.paddingRight = ''; // Réinitialiser le padding ajouté au body
});
});
		</script>
		<script>
			document.addEventListener('DOMContentLoaded', function () {
const bellIcon = document.querySelector('.notificone');

setInterval(() => {
bellIcon.classList.add('vibrate-strong');
setTimeout(() => {
bellIcon.classList.remove('vibrate-strong');
}, 1000); // Durée de l'animation en millisecondes
}, 3000); // Intervalle de 3 secondes
});
		</script>


		<script>
			// public/js/optimization.js

document.addEventListener('DOMContentLoaded', function () { // Chargement paresseux des images
const lazyImages = document.querySelectorAll('img[data-src]');
const imageObserver = new IntersectionObserver((entries, observer) => {
entries.forEach(entry => {
if (entry.isIntersecting) {
const img = entry.target;
img.src = img.getAttribute('data-src');
img.removeAttribute('data-src');
imageObserver.unobserve(img);
}
});
});

lazyImages.forEach(img => {
imageObserver.observe(img);
});

// Préchargement des ressources critiques
const preloadLinks = document.querySelectorAll('link[rel="preload"]');
preloadLinks.forEach(link => {
const url = link.getAttribute('href');
const preloadLink = document.createElement('link');
preloadLink.rel = 'preload';
preloadLink.href = url;
preloadLink.as = link.getAttribute('as');
document.head.appendChild(preloadLink);
});

// Amélioration de la gestion du cache
const cacheResources = () => {
const resources = [
{
url: '/css/styles.css',
type: 'style'
}, {
url: '/js/scripts.js',
type: 'script'
},
// Ajoute ici d'autres ressources à mettre en cache
];
resources.forEach(resource => {
if (resource.type === 'style') {
const link = document.createElement('link');
link.rel = 'stylesheet';
link.href = resource.url;
document.head.appendChild(link);
} else if (resource.type === 'script') {
const script = document.createElement('script');
script.src = resource.url;
script.async = true;
document.body.appendChild(script);
}
});
};

cacheResources();
});

		</script>


		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
	{% endblock %}
