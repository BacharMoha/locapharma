{% extends 'base.html.twig' %}

{% block title %}Recherche Médicament - LocaPharma
{% endblock %}

{% block stylesheets %}
	<link rel="stylesheet" href="{{ asset('assets/css/styles.css') }}">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-xxx" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

{% endblock %}

{% block body %}

	<div class="container">
		<header class="row align-items-center">

			<style>


				body {
					min-height: 100vh;
					display: flex;
					flex-direction: column;

				}

				main {
					flex: 1;
				}
				header {
					display: flex;
					justify-content: space-between;
					align-items: center;
					padding: 10px 0;
				}

				h1 {
					color: #0056b3;
					font-size: 30px;
				}

				.notifications img {
					width: 24px;
					height: 24px;
				}

				.pharmacy-list {
					list-style-type: none;
					padding: 0;
					margin: 20px 0;
				}


				.pharmacy-item img {
					width: 70px;
					height: 70px;
				}

				.btn-disponible {
					background-color: #28a745;
					color: white;
					border: none;
					padding: 8px 20px;
					border-radius: 25px;
					cursor: pointer;
				}


				.nmPh {
					font-size: 25px;
					font-family: "Blippo", fantasy;
					color: #1160c3;
					margin-left: 0;

				}

				.nmMdc {
					display: block;
					margin-top: 5%;
					font-size: 17px;
					font-family: "Comic Sans MS", cursive, sans-serif;
					background: linear-gradient(45deg, #3e8b40, #91cc4e);
					color: #fff;
					padding: 3px;
					border-radius: 10px;
				}


				.bottom-nav {
					display: flex;
					justify-content: space-around;
					align-items: center;
					padding: 10px 0;
					background-color: #fff;
					border-top: 1px solid #ddd;
					position: fixed;
					bottom: 0;
					width: 100%;
					height: 75px;
					box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
				}

				.bottom-nav a {
					color: #0056b3;
					text-decoration: none;
					font-size: 14px;
					text-align: center;
				}

				.nav-item {
					text-align: center;
					flex: 1;
				}

				.nav-item svg {
					display: block;
					margin: 0 auto 5px;
					text-align: center;
				}

				.nav-item span {
					display: block;
					font-size: 20px;
					color: #333;
				}

				#btn-insponible {
					background: red;
					font-size: 14px;
				}

				main {
					margin-top: 5%;
				}

				.search-bar {
					display: flex;
					align-items: center;
					justify-content: center;
				}

				.search-bar input {
					padding: 10px;
					border-radius: 25px;
					border: 1px solid #0839CF;
					width: 100%;
					box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
				}

				.search-btn {
					background-color: transparent;
					border: none;
					margin-left: -35px;
				}

				/* Styles spécifiques pour les petites résolutions */
				@media(max-width: 576px) {
					.bottom-nav {
						flex-direction: column;
						height: auto;
						padding: 5px 0;
					}

					.nav-item {
						margin-bottom: 10px;
					}

					.nav-item span {
						font-size: 10px;
					}
				}


				#btn-insponible {
					background: red;
					font-size: 14px;
				}

				main {
					margin-top: 5%;
				}

				.search-bar {
					display: flex;
					align-items: center;
					justify-content: center;
				}

				.search-bar input {
					padding: 10px;
					border-radius: 25px;
					border: 1px solid #0839CF;
					width: 100%;
					box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
				}

				.search-btn {
					background-color: transparent;
					border: none;
					margin-left: -35px;
				}

				/* Responsive styles */
				@media(max-width: 992px) {
					header {
						flex-direction: column;
					}

					#locfr {
						margin-left: -100%;
					}

					.notifications {
						margin-top: -47.3%;
						position: absolute;
						margin-left: 178%;

					}
					.nmMdc {

						font-size: 30px;
						font-weight: bolder;
						border-radius: 10%;

					}
				}
				.disponible {
					margin-left: 64%;
				}
				@media(max-width: 768px) {
					.pharmacy-item {
						flex-direction: column;
						align-items: flex-start;
					}

					.nmPh,
					.nmMdc {
						font-size: 16px;
					}

					.btn-disponible {
						width: 100%;
						text-align: center;
						margin-top: 10px;
					}
				}

				@media(max-width: 576px) {
					.search-bar input {
						width: 500%;
					}


					.nav-item {
						margin-bottom: 10px;
					}

					.nav-item span {
						font-size: 10px;
					}

					.notifications {
						margin-top: 10px;
					}


				}

				@media(max-width:1492px) {
					footer {
						margin-right: 13%;
						position: relative;

					}
				}
				@media(max-width:1448px) {
					footer {
						margin-right: 13%;
						position: relative;

					}
				}
				footer {
					position: fixed; /* ou fixed si vous voulez qu'il reste en bas */
					width: 100%;
					margin: 0; /* Supprimez les marges négatives */
					padding: 10px 0;
					background-color: #fff;
					text-align: center;
					box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
					bottom: 0; /* Garder le footer en bas */
				}

				@media(max-width: 992px) {
					footer {
						margin-left: 0;
						padding: 10px;
						text-align: center;
					}
					.text-muted {
						font-size: x-large;
						display: -webkit-box;
						-webkit-line-clamp: 2; /* Afficher seulement 3 lignes */
						-webkit-box-orient: vertical;
						overflow: hidden;
						text-overflow: ellipsis; /* Ajouter "..." à la fin du texte coupé */
						max-height: 4.5em; /* Approximation de 3 lignes selon la taille de la ligne */
						line-height: 1.5em; /* Hauteur de chaque ligne */
					}
					.nmPh {
						font-size: x-large;
					}
					.nmMdc {
						font-size: x-large;
					}
					.disponible {

						margin-left: 58%;

					}
				}
				/* Ajoutez ce CSS à vos styles existants */

				.image-cage img:hover {
					transform: scale(1.3); /* Augmente la taille de l'image au survol */
				}

				.image-cage {
					overflow: hidden; /* La "cage" qui retient l'image */
					border-radius: 20%;
				}

				.notification-badge {
					position: absolute;
					top: -10px;
					right: -10px;
					background-color: red;
					color: white;
					border-radius: 50%;
					width: 20px;
					height: 20px;
					display: flex;
					align-items: center;
					justify-content: center;
					font-size: 12px;
					font-weight: bold;
				}
				.modal-content {
					border-radius: 20px;
					padding: 30px;
					box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
				}

				.modal-title {
					font-family: 'Arial', sans-serif;
					font-size: 1.3rem;
					color: #0839CF;
				}

				.modal-body .notification-date {
					font-family: 'Arial', sans-serif;
					font-size: 1rem;
					color: #666666;

				}

				.modal-body .notification-body {
					font-family: 'Arial', sans-serif;
					font-size: 1rem;
					margin-top: 10px;
					color: #333333;
				}

				.btn-primary {
					border-radius: 20px;
					background-color: #0839CF;
					color: #ffffff;
				}

				.btn-primary:hover {
					background-color: #052a94;
				}
				.medicament-info {
					display: flex;
					align-items: center;
				}

				.location-link {
					display: flex;
					align-items: center;
					text-decoration: none; /* Supprime le soulignement du lien */
					color: inherit; /* Conserve la couleur du texte du parent */
				}

				.location-icon {
					color: #052a94; /* Couleur de l'icône, personnalise selon tes besoins */
					font-size: 35px; /* Taille de l'icône, ajuste selon tes besoins */
					margin-right: 35px; /* Espacement entre l'icône et le texte */
					position: absolute;
					margin-left: 15%;
				}

				.location-text {
					font-size: 14px; /* Taille du texte, ajuste selon tes besoins */
				}
				@media(max-width: 992px) {
					footer {

						margin-left: 0;
						padding: 10px;
						text-align: center;

					}

					.bottom-nav svg {
						height: 40px;
						width: 40px;
						margin-left: -2%;
					}
					.bottom-nav {
						height: 100px;

					}
					span {
						margin-left: -82%;
					}
					.imgs {
						height: 130px;
						width: 130px;
					}
					.card-text-center {

						font-size: 40px; /* Ajuste la taille de la police si nécessaire */


					}
					.btn-primary {
						width: 30%;
						height: 60px;
						font-size: 30px;
					}
					.vvv {}
					.modal-content {

						font-size: 30px;
					}

					.modal-title {
						font-size: 30px;
					}

					.modal-body .notification-date {
						font-family: 'Arial', sans-serif;
						font-size: 2rem;
						color: #666666;

					}

					.modal-body .notification-body {
						font-size: 30px;
					}
					.notificone {
						height: 60px;
						width: 60px;
					}
					.notification-badge {
						font-size: 20px;
						width: 28px;
						height: 28px;
						top: -10px;
						right: -19px;
					}
					.imgl {
						height: 120px;
						width: 210px;
					}
					.search-bar input {
						height: 65px;
						border-radius: 30px;
						font-size: 23px;
						min-width: 600px;

					}


				}
				@keyframes strongShake {
					0% {
						transform: rotate(0deg);
					}
					10% {
						transform: rotate(10deg);
					}
					20% {
						transform: rotate(-10deg);
					}
					30% {
						transform: rotate(10deg);
					}
					40% {
						transform: rotate(-10deg);
					}
					50% {
						transform: rotate(8deg);
					}
					60% {
						transform: rotate(-8deg);
					}
					70% {
						transform: rotate(5deg);
					}
					80% {
						transform: rotate(-5deg);
					}
					90% {
						transform: rotate(2deg);
					}
					100% {
						transform: rotate(0deg);
					}
				}

				.vibrate-strong {
					animation: strongShake 0.7s;
					animation-iteration-count: 1;
					transform-origin: top center; /* Fixer le sommet */
				}
			</style>

			<nav style="margin-top: -12%;">
				<div class="container">
					<header class="row align-items-center" style="margin-top: 10%;">
						<div class="col-md-4 text-center text-md-start">
							<a href="{{ path('app_index') }}">
								<img class="imgl" src="{{ asset('images/iconelocapharna.png') }}" id="locfr" width="206" height="100" alt="Pharmacy Icon">
							</a>
						</div>
						<div class="col-md-4 text-center my-2 my-md-0">
							<div class="search-bar">
								<form method="get" action="{{ path('recherche_medicament') }}" id="searchForm">
									<input style="width:350px;" type="text" placeholder="Rechercher un Médicament" id="searchInput" name="nom" value="{{ nom }}" class="form-control" oninput="submitForm()"/>
								</form>
								<button class="search-btn btn btn-link p-0">
									<i class="bi bi-search"></i>
									<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewbox="0 0 16 16">
										<path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
									</svg>
								</button>
							</div>
						</div>
						<div class="col-md-4 text-center text-md-end">
							<a href="" data-bs-toggle="modal" data-bs-target="#notificationModal">
								<div class="notifications position-relative">
									<i class="bi bi-bell"></i>
									<svg class="notificone" style="color: #0839CF;" xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-bell-fill" viewbox="0 0 16 16">
										<path d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2m.995-14.901a1 1 0 1 0-1.99 0A5 5 0 0 0 3 6c0 1.098-.5 6-2 7h14c-1.5-1-2-5.902-2-7 0-2.42-1.72-4.44-4.005-4.901"/>
									</svg>

									{% if notification_count > 0 %}
										<span class="notification-badge">{{ notification_count }}</span>
									{% endif %}
								</div>
							</a>
						</div>


						<div class="modal fade" id="notificationModal" tabindex="-1" aria-labelledby="notificationModalLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="notificationModalLabel" style="font-size: 15px;">Tous les notification</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									{% for notification in notifications %}
										<div class="modal-body">
											<p class="modal-title ">{{ notification.title }}</p>
											<p class="notification-body">{{ notification.body }}</p>
											<p class="notification-date" style="float:right;margin-top:25px;">Publié le
												{{ notification.createdAt|date('d M Y') }}</p>
										</div>
										<hr>
									{% else %}
										<p>Aucune notification disponible.</p>
									{% endfor %}
									<div class="modal-footer">
										<button type="button" class="btn btn-primary" data-bs-dismiss="modal">Quitter</button>
									</div>
								</div>
							</div>
						</div>
					</header>
					<main class="container mt-5">
						<div class="row g-3">
							{% if medicaments is not empty %}
								{% for medicament in medicaments %}
									<div class="col-12">
										<div class="card shadow-sm" style="border-radius: 20px; height: 230px; box-shadow: 0 5px 10px rgba(0, 0, 1, 5.7); position: relative; overflow: hidden;">
											<div class="row g-0">
												<div class="col-md-4">
													<div class="image-cage" style="width: 100%; height: 100%; overflow: hidden; border-radius: 20px; margin-bottom: -35%;">
														<img style="cursor: pointer;" src="{{ asset('images/' ~ medicament.image) }}" class="img-fluid" alt="Medicament Icon" style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease;" data-name="{{ medicament.nomMedoc }}" data-description="{{ medicament.description }}" data-image="{{ asset('images/' ~ medicament.image) }}" data-bs-toggle="modal" data-bs-target="#imageModal">
													</div>
												</div>
												<div class="col-md-8">
													<div class="card-body">
														{% for pharmacie in medicament.pharmacies %}
															<h5 class="card-title nmPh">{{ pharmacie.nomPharma }}
															</h5>
														{% endfor %}
														{# <div class="medicament-info">
																																																																																																		    <a href="" target="_blank" class="location-link">
																																																																																																		        <i class="fas fa-map-marker-alt location-icon"><b style="font-size: 12px;">Nous retrouver</b></i>
																																																																																																		        <span class="location-text"></span>
																																																																																																		    </a>
																																																																																																		</div> #}
														<p class="card-text nmMdc" style="font-size: px;">
															<strong>
																<b>
																	{{medicament.nomMedoc}}</b>
															</strong>
														</p>
														<p class="card-text">
															<small class="text-muted">
																<text>{{medicament.description}}</text>
															</small>
														</p>
														<div class="d-flex">
															<div>
																<button
																	class="btn btn-success" style="border-radius: 10px; background: rgb(43, 167, 13); border: none; width: 120px;">{# <b>
																																																																																																																																														{{medicament.prix}} KMF.
																																																																																																																																													</b> #}
																</button>
															</div>

															<div class=" disponible d-flex justify-content-between align-items-center" style="">
																<a href="#" target="_blank" style="border: none;"></a>
																{% if medicament.isDisponible %}

																	<button class="btn btn-success" style="border-radius: 20px;">Disponible</button>
																{% else %}
																	<button class="btn btn-danger" style="border-radius: 20px;">Indisponible</button>

																{% endif %}
															</div>
														</div>


													</div>
												</div>
											</div>
										</div>
									</div>

								{% endfor %}
							{% else %}
								<div id="pharamacieLi">
									<p class="description" style="margin-top: 15%; text-align:center" id="nn">Aucun médicament trouvé pour la recherche "{{ nom }}"!</p>
								</div>
							{% endif %}
							<!-- Card 1 -->

						</div><br>


					</main>


				</div>

				<!-- Modal -->
				<div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
					<div class="modal-dialog modal-dialog-centered">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title" id="imageModalLabel"></h5>
								<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
							</div>
							<div class="modal-body">
								<img id="modalImage" src="" class="img-fluid" alt="Image">
								<p style="padding:5%;">
									<small class="text-mute">
										<text id="modalDescription" style="color: #0839CF;"></text>
									</small>
								</p>
							</div>

							<div class="modal-footer">
								<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
							</div>
						</div>
					</div>
				</div>


			</div>
			<footer>
				<nav class="bottom-nav">
					<a href="{{ path('app_index') }}" class="imgs" style="margin-left: 10%;">
						<img src="{{ asset('images/logoloca-removebg-preview.png') }}" id="locfr" width="115" height="115" alt="Pharmacy Icon">
					</a>
					<a href="{{ path('app_index') }}" class="nav-item">
						<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-house-fill" viewbox="0 0 16 16">
							<path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L8 2.207l6.646 6.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293z"/>
							<path d="m8 3.293 6 6V13.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5V9.293z"/>
						</svg>
						<span>Accueil</span>
					</a>
					<a href="{{ path('pharmacie_proche') }}" class="nav-item">
						<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-geo-alt-fill" viewbox="0 0 16 16">
							<path fill-rule="evenodd" d="M12 6a4 4 0 1 0-8 0 4 4 0 0 0 8 0ZM8 0a6 6 0 0 0-6 6c0 1.7.924 3.68 2.287 5.329.678.843 1.454 1.593 2.155 2.146.354.28.688.528.958.711.134.091.252.165.345.217l.066.036.017.01h.002l.001.001s0-.001.4.202a.25.25 0 0 0 .234 0s.4-.202.4-.202l.002-.001h.001l.017-.01.066-.036c.093-.052.211-.126.345-.217.27-.183.604-.43.958-.711.701-.553 1.477-1.303 2.155-2.146C13.076 9.68 14 7.7 14 6a6 6 0 0 0-6-6Z"/>
						</svg>
						<span>Pharmacie proche</span>
					</a>
					<a href="{{ path('pharmacie_garde') }}" class="nav-item">
						<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" ç fill="currentColor" class="bi bi-clock-fill" viewbox="0 0 16 16">
							<path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0ZM7.5 3.5a.5.5 0 0 0-1 0V8a.5.5 0 0 0 .276.447l3.5 1.75a.5.5 0 0 0 .448-.894L7.5 7.742V3.5Z"/>
						</svg>
						<span>Pharmacie de garde</span>
					</a>
					<a href="{{ path('recherche_medicament') }}" class="nav-item">
						<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-search" viewbox="0 0 16 16">
							<path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001a1.007 1.007 0 0 0-.116.125l-2.45 2.45a1 1 0 0 0 1.415 1.415l2.45-2.45a1.007 1.007 0 0 0 .125-.116v-.001a6.5 6.5 0 0 0 1.398-1.397zm-6.321-5.027a5.5 5.5 0 1 1 7.778 7.778 5.5 5.5 0 0 1-7.778-7.778z"/>
						</svg>
						<span>Médicaments</span>
					</a>

				</nav>
			</footer>
			<script>
				document.getElementById('searchInput').addEventListener('input', function () {
var input = this.value;
if (input.length >= 3) {
document.getElementById('searchForm').submit();
}
});
			</script>
			<script>
				document.addEventListener('DOMContentLoaded', function () {
const cards = document.querySelectorAll('.card img');
const modal = new bootstrap.Modal(document.getElementById('imageModal'));
const modalImage = document.getElementById('modalImage');
const modalTitle = document.getElementById('imageModalLabel');
const modalDescription = document.querySelector('.modal-body p small text');

// Réinitialiser les événements sur les images à chaque chargement
cards.forEach(card => {
card.addEventListener('click', function (event) {
const clickedImage = event.target;

// Récupérer les données depuis les attributs data-*
const name = clickedImage.getAttribute('data-name');
const description = clickedImage.getAttribute('data-description');
const image = clickedImage.getAttribute('data-image');
const price = clickedImage.getAttribute('data-price');

// Mettre à jour le contenu de la modale
modalImage.src = image;
modalTitle.textContent = name;
modalDescription.textContent = description;
});
});
});
			</script>

			<script>
				document.addEventListener('DOMContentLoaded', function () {
const bellIcon = document.querySelector('.notificone');

setInterval(() => {
bellIcon.classList.add('vibrate-strong');
setTimeout(() => {
bellIcon.classList.remove('vibrate-strong');
}, 700); // Durée de l'animation en millisecondes
}, 3000); // Intervalle de 3 secondes
});
			</script>
			<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
			<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
			<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
		{% endblock %}
